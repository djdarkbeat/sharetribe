<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Admin::ListingShapesController::FormViewLayer
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Admin::ListingShapesController::FormViewLayer";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Admin.html" title="Admin (module)">Admin</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../ListingShapesController.html" title="Admin::ListingShapesController (class)">ListingShapesController</a></span></span>
     &raquo; 
    <span class="title">FormViewLayer</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Admin::ListingShapesController::FormViewLayer
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/controllers/admin/listing_shapes_controller.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>FormViewLayer provides helper functions to transform:</p>
<ul><li>
<p>Shape hash to renderable format</p>
</li><li>
<p>params from form back to Shape</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encode_custom_units-class_method" title="encode_custom_units (class method)">.<strong>encode_custom_units</strong>(custom_units)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expand_predefined_units-class_method" title="expand_predefined_units (class method)">.<strong>expand_predefined_units</strong>(shape_units)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#params_to_shape-class_method" title="params_to_shape (class method)">.<strong>params_to_shape</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_existing_custom_units-class_method" title="parse_existing_custom_units (class method)">.<strong>parse_existing_custom_units</strong>(existing_units)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_new_custom_units-class_method" title="parse_new_custom_units (class method)">.<strong>parse_new_custom_units</strong>(new_units)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_predefined_units-class_method" title="parse_predefined_units (class method)">.<strong>parse_predefined_units</strong>(selected_units)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_units_from_params-class_method" title="parse_units_from_params (class method)">.<strong>parse_units_from_params</strong>(form_params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Combines availability units and pricing units to just “units”.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shape_to_locals-class_method" title="shape_to_locals (class method)">.<strong>shape_to_locals</strong>(shape)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#split_availability_and_pricing_units-class_method" title="split_availability_and_pricing_units (class method)">.<strong>split_availability_and_pricing_units</strong>(shape)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Splits units to availability units and pricing units.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="encode_custom_units-class_method">
  
    .<strong>encode_custom_units</strong>(custom_units)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


401
402
403
404
405
406
407
408</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 401</span>

<span class='kw'>def</span> <span class='id identifier rubyid_encode_custom_units'>encode_custom_units</span><span class='lparen'>(</span><span class='id identifier rubyid_custom_units'>custom_units</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_custom_units'>custom_units</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span>
    <span class='lbrace'>{</span>
      <span class='label'>name:</span> <span class='id identifier rubyid_u'>u</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>value:</span> <span class='const'><span class='object_link'><a href="../../ListingShapeDataTypes.html" title="ListingShapeDataTypes (module)">ListingShapeDataTypes</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../ListingShapeDataTypes.html#Unit-constant" title="ListingShapeDataTypes::Unit (constant)">Unit</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize'>serialize</span><span class='lparen'>(</span><span class='id identifier rubyid_u'>u</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expand_predefined_units-class_method">
  
    .<strong>expand_predefined_units</strong>(shape_units)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


394
395
396
397
398
399</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 394</span>

<span class='kw'>def</span> <span class='id identifier rubyid_expand_predefined_units'>expand_predefined_units</span><span class='lparen'>(</span><span class='id identifier rubyid_shape_units'>shape_units</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_shape_units_set'>shape_units_set</span> <span class='op'>=</span> <span class='id identifier rubyid_shape_units'>shape_units</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='lbracket'>[</span><span class='symbol'>:unit_type</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_set'>to_set</span>

  <span class='const'><span class='object_link'><a href="../../ListingShapeHelper.html" title="ListingShapeHelper (module)">ListingShapeHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_predefined_unit_types'><span class='object_link'><a href="../../ListingShapeHelper.html#predefined_unit_types-class_method" title="ListingShapeHelper.predefined_unit_types (method)">predefined_unit_types</a></span></span>
    <span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='lbrace'>{</span><span class='label'>unit_type:</span> <span class='id identifier rubyid_t'>t</span><span class='comma'>,</span> <span class='label'>enabled:</span> <span class='id identifier rubyid_shape_units_set'>shape_units_set</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>label:</span> <span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_t'>t</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>admin.listing_shapes.units.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_t'>t</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="params_to_shape-class_method">
  
    .<strong>params_to_shape</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


329
330
331
332
333
334
335
336
337
338</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 329</span>

<span class='kw'>def</span> <span class='id identifier rubyid_params_to_shape'>params_to_shape</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_form_params'>form_params</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../HashUtils.html" title="HashUtils (module)">HashUtils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_symbolize_keys'><span class='object_link'><a href="../../HashUtils.html#symbolize_keys-class_method" title="HashUtils.symbolize_keys (method)">symbolize_keys</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_to_unsafe_hash'>to_unsafe_hash</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_parsed_params'>parsed_params</span> <span class='op'>=</span> <span class='id identifier rubyid_form_params'>form_params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span>
    <span class='label'>units:</span> <span class='id identifier rubyid_parse_units_from_params'>parse_units_from_params</span><span class='lparen'>(</span><span class='id identifier rubyid_form_params'>form_params</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>author_is_seller:</span> <span class='id identifier rubyid_form_params'>form_params</span><span class='lbracket'>[</span><span class='symbol'>:author_is_seller</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>false</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># default true
</span>  <span class='rparen'>)</span>

  <span class='const'><span class='object_link'><a href="../ListingShapesController.html#Shape-constant" title="Admin::ListingShapesController::Shape (constant)">Shape</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_parsed_params'>parsed_params</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_existing_custom_units-class_method">
  
    .<strong>parse_existing_custom_units</strong>(existing_units)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


414
415
416
417
418
419</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 414</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_existing_custom_units'>parse_existing_custom_units</span><span class='lparen'>(</span><span class='id identifier rubyid_existing_units'>existing_units</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_existing_units'>existing_units</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_unit'>unit</span><span class='op'>|</span>
    <span class='const'><span class='object_link'><a href="../../ListingShapeDataTypes.html" title="ListingShapeDataTypes (module)">ListingShapeDataTypes</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../ListingShapeDataTypes.html#Unit-constant" title="ListingShapeDataTypes::Unit (constant)">Unit</a></span></span><span class='period'>.</span><span class='id identifier rubyid_deserialize'>deserialize</span><span class='lparen'>(</span><span class='id identifier rubyid_unit'>unit</span><span class='rparen'>)</span>
      <span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>unit_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>custom</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>enabled:</span> <span class='kw'>true</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_new_custom_units-class_method">
  
    .<strong>parse_new_custom_units</strong>(new_units)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


421
422
423
424
425
426</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 421</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_new_custom_units'>parse_new_custom_units</span><span class='lparen'>(</span><span class='id identifier rubyid_new_units'>new_units</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new_units'>new_units</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:second</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span>
    <span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>unit_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>custom</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>enabled:</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='period'>.</span><span class='id identifier rubyid_except'>except</span><span class='lparen'>(</span><span class='symbol'>:name_tr_key</span><span class='comma'>,</span> <span class='symbol'>:selector_tr_key</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_predefined_units-class_method">
  
    .<strong>parse_predefined_units</strong>(selected_units)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


410
411
412</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 410</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_predefined_units'>parse_predefined_units</span><span class='lparen'>(</span><span class='id identifier rubyid_selected_units'>selected_units</span><span class='rparen'>)</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_selected_units'>selected_units</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='op'>|</span> <span class='lbrace'>{</span><span class='label'>unit_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='label'>enabled:</span> <span class='kw'>true</span><span class='rbrace'>}</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_units_from_params-class_method">
  
    .<strong>parse_units_from_params</strong>(form_params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Combines availability units and pricing units to just “units”.</p>

<p>In the backend we have only one concept, units. However, in the UI we are showing pricing unit checkboxes and availability unit radio buttons. This method maps the UI units to backend units.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


381
382
383
384
385
386
387
388
389
390
391
392</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 381</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_units_from_params'>parse_units_from_params</span><span class='lparen'>(</span><span class='id identifier rubyid_form_params'>form_params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_selected_predefined_units'>selected_predefined_units</span> <span class='op'>=</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_form_params'>form_params</span><span class='lbracket'>[</span><span class='symbol'>:availability</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>booking</span><span class='tstring_end'>&quot;</span></span>
      <span class='lbracket'>[</span><span class='id identifier rubyid_form_params'>form_params</span><span class='lbracket'>[</span><span class='symbol'>:availability_unit</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_form_params'>form_params</span><span class='lbracket'>[</span><span class='symbol'>:units</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

  <span class='id identifier rubyid_parse_predefined_units'>parse_predefined_units</span><span class='lparen'>(</span><span class='id identifier rubyid_selected_predefined_units'>selected_predefined_units</span><span class='rparen'>)</span>
    <span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_parse_existing_custom_units'>parse_existing_custom_units</span><span class='lparen'>(</span><span class='const'>Maybe</span><span class='lparen'>(</span><span class='id identifier rubyid_form_params'>form_params</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='symbol'>:custom_units</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:existing</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_or_else'>or_else</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_parse_new_custom_units'>parse_new_custom_units</span><span class='lparen'>(</span><span class='const'>Maybe</span><span class='lparen'>(</span><span class='id identifier rubyid_form_params'>form_params</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='symbol'>:custom_units</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:new</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_or_else'>or_else</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="shape_to_locals-class_method">
  
    .<strong>shape_to_locals</strong>(shape)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


340
341
342
343
344
345
346
347
348
349
350</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 340</span>

<span class='kw'>def</span> <span class='id identifier rubyid_shape_to_locals'>shape_to_locals</span><span class='lparen'>(</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_shape'>shape</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../ListingShapesController.html#Shape-constant" title="Admin::ListingShapesController::Shape (constant)">Shape</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_units'>units</span> <span class='op'>=</span> <span class='id identifier rubyid_split_availability_and_pricing_units'>split_availability_and_pricing_units</span><span class='lparen'>(</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_shape'>shape</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span>
    <span class='label'>availability_unit:</span> <span class='id identifier rubyid_units'>units</span><span class='lbracket'>[</span><span class='symbol'>:availability</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>predefined_units:</span> <span class='id identifier rubyid_expand_predefined_units'>expand_predefined_units</span><span class='lparen'>(</span><span class='id identifier rubyid_units'>units</span><span class='lbracket'>[</span><span class='symbol'>:pricing</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>custom_units:</span> <span class='id identifier rubyid_encode_custom_units'>encode_custom_units</span><span class='lparen'>(</span><span class='id identifier rubyid_units'>units</span><span class='lbracket'>[</span><span class='symbol'>:pricing</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_unit'>unit</span><span class='op'>|</span> <span class='id identifier rubyid_unit'>unit</span><span class='lbracket'>[</span><span class='symbol'>:unit_type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>custom</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="split_availability_and_pricing_units-class_method">
  
    .<strong>split_availability_and_pricing_units</strong>(shape)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Splits units to availability units and pricing units.</p>

<p>In the backend we have only one concept, units. However, in the UI we are showing pricing unit checkboxes and availability unit radio buttons. This method maps backend units to the two unit formats we have in the UI</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


361
362
363
364
365
366
367
368
369
370
371
372
373</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/admin/listing_shapes_controller.rb', line 361</span>

<span class='kw'>def</span> <span class='id identifier rubyid_split_availability_and_pricing_units'>split_availability_and_pricing_units</span><span class='lparen'>(</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='symbol'>:availability</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>booking</span><span class='tstring_end'>&#39;</span></span>
    <span class='lbrace'>{</span>
      <span class='label'>pricing:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>availability:</span> <span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='symbol'>:units</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='symbol'>:unit_type</span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='lbrace'>{</span>
      <span class='label'>pricing:</span> <span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='symbol'>:units</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>availability:</span> <span class='kw'>nil</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Feb 11 14:01:45 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.6.2).
</div>

    </div>
  </body>
</html>